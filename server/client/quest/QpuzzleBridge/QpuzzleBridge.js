//11/28/2014 3:58 PM
/*jslint node: true, undef:true, sub:true, asi:true, funcscope:true, forin:true, unused:false*//*global True, False, loadAPI*/
/*Go to http://jshint.com/ and copy paste your code to spot syntax errors.*/

'use strict';
var s = loadAPI('v1.0','QpuzzleBridge',{
	name:"Puzzle & Bridge",
	author:"rc",
	maxParty:1,
	thumbnail:true,
	category:["Puzzle"],
	solo:true,
	party:"No",
	zone:"QfirstTown-east",
	reward:{"ability":{'Qsystem-player-healFast':0.5}},
	scoreModInfo:"Depends on amount of puzzles done.",
	description:"Puzzle where you need to move blocks to form a bridge.",
});
var m = s.map; var b = s.boss; var g;

/* COMMENT:
Move bridge part to create a bridge and go to next puzzle
*/

s.newVariable({
	lvl:0,
	chrono:0,
	pushCount:0,
	resetCount:0,
	startGame:false,
});

s.newHighscore('speedrun',"Fastest Time","Fastest Time completing all 5 puzzles.",'ascending',function(key){
	if(s.get(key,'lvl') >= 5) return s.get(key,'chrono')*40;
	return null;
});
s.newHighscore('pushing',"Least Push","Least amount of pushes.",'ascending',function(key){
	if(s.get(key,'lvl') >= 5) return s.get(key,'pushCount');
	return null;
});

s.newChallenge('speedrun',"Speedrun","Complete all 5 puzzles in less than 10 minutes.",function(key){
	if(s.get(key,'lvl') >= 5) return s.get(key,'chrono') < 10*60*25;
	return false;
});
s.newChallenge('pushing',"Pusher","Complete all 5 puzzles with less than 250 pushes.",function(key){
	if(s.get(key,'lvl') >= 5) 
		return s.get(key,'pushCount') < 250;
	return false;
});
s.newChallenge('noreset',"No Reset","Complete all 5 puzzles without resetting.",function(key){
	if(s.get(key,'lvl') >= 5) return s.get(key,'resetCount') <= 5;	//5 is minimum
	return false;
});

s.newEvent('_start',function(key){ //
	if(s.isAtSpot(key,'QfirstTown-east','t5',200))
		s.callEvent('talkPoont',key);
	s.addQuestMarker(key,'myQuestMarker','QfirstTown-east','t5');
});
s.newEvent('_getScoreMod',function(key){ //impact reputation pts given
	var lvl = s.get(key,'lvl');
	if(lvl <= 3) return 0.1;
	if(lvl === 4) return 1;
	if(lvl === 5) return 3;
});
s.newEvent('_abandon',function(key){ //
	if(s.isInQuestMap(key)){
		s.teleport(key,'QfirstTown-east','t5','main');
		s.setRespawn(key,'QfirstTown-east','t5','main');
	}
});
s.newEvent('_complete',function(key){ //
	s.callEvent('_abandon',key);
});
s.newEvent('_hint',function(key){ //
	if(!s.get(key,'startGame'))
		return 'Go talk to Poont.';
	if(!s.isChallengeActive(key,'pushing'))
		return "Move the bridge parts to form bridge then activate switch. If stuck, use item.";
	else
		return 'Push Count: ' + s.get(key,'pushCount');
});
s.newEvent('_signIn',function(key){ //
	var lvl = s.get(key,'lvl');
	if(lvl === 0) s.teleport(key,'g0','t1','solo',true);
	else if(lvl === 1) s.teleport(key,'g1','t1','solo',true);
	else if(lvl === 2) s.teleport(key,'g3','t1','solo',true); //s.teleport(key,'g2','t1','solo',true);
	else if(lvl === 3) s.teleport(key,'g2','t1','solo',true); //s.teleport(key,'g3','t1','solo',true);
	else if(lvl === 4) s.teleport(key,'g4','t1','solo',true);
});
s.newEvent('_death',function(key){ //
	s.failQuest(key);
});
s.newEvent('startGame',function(key){ //
	s.set(key,'startGame',true);
	s.startChrono(key,'timer',!!s.isChallengeActive(key,'speedrun'));
	s.displayPopup(key,'Use item "Reset" if stuck.');
	s.teleport(key,'g0','t1','solo',true);	
	s.addItem(key,'stuck');	
	s.enableAttack(key,false);
});
s.newEvent('pushRock',function(key){ //
	s.add(key,'pushCount',1);
});
s.newEvent('endGame',function(key){ //
	s.displayPopup(key,'You fixed the glitched chest.',25*5);
	s.setTimeout(key,function(){
		s.set(key,'lvl',5);
		s.set(key,'chrono',s.stopChrono(key,'timer'));
		s.completeQuest(key);
	},25*3);
	
});
s.newEvent('saveBridge',function(key,map){ //return object with position of every bridge
	var tmp = [];
	s.forEachActor(key,map,function(key){
		tmp.push(s.getPosition(key));
	},'npc',null,{bridge:true});
	return tmp;
});
s.newEvent('placeBridge',function(key,map,tmp){ //create bridges using saveBridge object
	for(var i = 0; i < tmp.length; i++){
		s.spawnActor(key,map,{x:tmp[i].x,y:tmp[i].y},'block-bridgeH');
	}
});
s.newEvent('tgOn0',function(key){ //when activating switch in land map
	var list = s.callEvent('saveBridge',key,'g0');		//save position
	s.teleport(key,'w0','t1','solo',true);	//teleport player
	s.callEvent('placeBridge',key,'w0',list);			//place bridge
	s.add(key,'resetCount',1);
});
s.newEvent('tgOn1',function(key){ //
	var list = s.callEvent('saveBridge',key,'g1');
	s.teleport(key,'w1','t2','solo',true);
	s.callEvent('placeBridge',key,'w1',list);
	s.add(key,'resetCount',1);
});
s.newEvent('tgOn2',function(key){ //
	var list = s.callEvent('saveBridge',key,'g2');
	s.teleport(key,'w2','t2','solo',true);
	s.callEvent('placeBridge',key,'w2',list);
	s.add(key,'resetCount',1);
});
s.newEvent('tgOn3',function(key){ //
	var list = s.callEvent('saveBridge',key,'g3');
	s.teleport(key,'w3','t2','solo',true);
	s.callEvent('placeBridge',key,'w3',list);
	s.add(key,'resetCount',1);
});
s.newEvent('tgOn4',function(key){ //
	var list = s.callEvent('saveBridge',key,'g4');
	s.teleport(key,'w4','t2','solo',true);
	s.callEvent('placeBridge',key,'w4',list);
	s.add(key,'resetCount',1);
});
s.newEvent('viewTg',function(key){ //
	return true;
});
s.newEvent('viewPreventBlock',function(key){ //
	return !s.isPlayer(key);
});
s.newEvent('tele01',function(key){ //0 => 1, 1 => 3, 3 => 2, 2 => 4
	s.teleport(key,'w1','t1','solo',true);
	s.set(key,'lvl',1);
});
s.newEvent('tele12',function(key){ //
	s.teleport(key,'w2','t1','solo',true);
	s.set(key,'lvl',2);
});
s.newEvent('tele23',function(key){ //
	s.teleport(key,'w3','t1','solo',true);
	s.set(key,'lvl',3);
	s.displayPopup(key,'Leaving now will complete the quest but with a considerable penalty.');
});
s.newEvent('tele34',function(key){ //
	s.teleport(key,'w4','t1','solo',true);
	s.set(key,'lvl',4);
	s.displayPopup(key,'Leaving now will complete the quest but with a big penalty.');
});
s.newEvent('teleQuit',function(key){ //when trying to leave, ask player first
	var str = s.get(key,'lvl') >= 3 
		? 'Leave and complete the quest but with a penalty?' 
		: 'Abandon the quest and leave?';
	s.displayQuestion(key,str,function(key){
		if(s.get(key,'lvl') < 3) s.failQuest(key);
		else s.completeQuest(key);
	});
});
s.newEvent('spawnRock',function(spot){ //
	m.spawnActor(spot,"pushable-rock2x2",{
		pushable:s.newNpc.pushable(8,8,'pushRock'),
	});
});
s.newEvent('spawnBlock',function(spot){ //
	m.spawnActor(spot,"block-rock2x2",{viewedIf:'viewPreventBlock'});
});
s.newEvent('spawnBridgeH',function(spot){ //
	m.spawnActor(spot,"pushable-bridgeH",{
		tag:{bridge:true},
		pushable:s.newNpc.pushable(8,8,'pushRock'),
	});
});
s.newEvent('spawnBridgeV',function(spot){ //
	m.spawnActor(spot,"block-template",{
		tag:{bridge:true},
		sprite:s.newNpc.sprite('block-bridgeV'),
		block:s.newNpc.block(s.newNpc.block.size(2,2),1,false,true,true),
	});
});
s.newEvent('spawn',function(spot,list){ //
	for(var i in list.bridgeH)	s.callEvent('spawnBridgeH',spot[list.bridgeH[i]]);
	for(var i in list.bridgeV)	s.callEvent('spawnBridgeV',spot[list.bridgeV[i]]);
	for(var i in list.block)	s.callEvent('spawnBlock',spot[list.block[i]]);
	for(var i in list.rock)	s.callEvent('spawnRock',spot[list.rock[i]]);
});
s.newEvent('talkPoont',function(key){	//
	s.startDialogue(key,'Poont','intro');
});

s.newItem('stuck',"Reset",'defensive-speed',[    //{
	s.newItem.option('_signIn',"Reset Puzzle","Use to reset the current puzzle.")
],''); //}

s.newDialogue('Poont','Poont','villagerFemale-0',[ //{ 
	s.newDialogue.node('intro',"Can you help me? Apparently there's a glitched chest if you follow this path. It would be very easy to fix but I can't seem to reach the chest.",[ 
		s.newDialogue.option("Why so?",'intro2','')
	],''),
	s.newDialogue.node('intro2',"Someone thought it would be a good idea to place that chest at the very end of a puzzle section. What an idiot!",[ 
		s.newDialogue.option("So what do I need to do?",'intro3',''),
	],''),
	s.newDialogue.node('intro3',"Just push rocks and bridge sections to form a bridge then raise the water with the switch. Have fun!",[ 
		s.newDialogue.option("Okay.",'','startGame'),
	],'')
]); //}

s.newMap('g0',{
	name:"Bridge Lvl 1",
	lvl:0,
	screenEffect:'weather',
	grid:["00000000000010000110000000011000010","00000000000010000110000000011000010","00000000000011111110000000011011010","00000001111011111110000000011011010","00000001111011111110000000011000010","00000001111011111110000000011000010","00000000000010000111000000111000010","01111000000010000111110011111000010","01111000000010000011110011110000010","01111000000010000001110011101111010","00000000000010000000110011001111010","00011111111100000000010010001111010","00100000000011110000010010000000010","01000000000011111111111111111111110","01011000000011111111111111111111110","01011011111100001111111111111111110","01000111111110001111111111111111110","01001100000011001111111111111111110","01111000000001101111110011111111110","01111000000001101111110011111111110","01111000000001101111110000111111110","01111000000011111111110000111111110","01111000000000001100000000000011110","01111000000000001100000000000011110","01111000000011111111111100000011110","01111100000011101111111100000011110","01111111001111101100000000111111110","01001111001111001100000000111111110","01000111001110001111001111111111110","01000011001111111111001111111111110","01111111001001111111001111111111110","01111111001000001111001111111111110","01111110000000001111001111111111110","01000000000000000000000001111000010","01000000000000000000000001111000010","01000000000000000000000001111000010","01000000000000000000000000000000010","01100000000000000000000000000000110","00110000000000000000000000000001100","00011111000000011111111111111111000","01101111100000111111111111111110000","01100000100000100000000000000000000","00000000100000100000000000000000000"],
	tileset:'v1.2'
},{
	spot:{t2:{x:736,y:48},s1:{x:288,y:608},b2:{x:736,y:608},t3:{x:288,y:672},b3:{x:736,y:672},b4:{x:608,y:736},b5:{x:672,y:736},g1:{x:800,y:736},b1:{x:864,y:736},q1:{x:928,y:736},t1:{x:368,y:1328}},
	load:function(spot){
		m.spawnToggle(spot.s1,'viewTg','tgOn0');
		m.spawnTeleporter(spot.t1,'teleQuit','zone','down');
		
		s.callEvent('spawn',spot,{
			bridgeH:['b1','b2','b3','b4','b5'],
			rock:['g1'],
			block:['q1'],
		});
	}
});
s.newMap('w0',{
	name:"Bridge Lvl 1",
	lvl:0,
	screenEffect:'weather',
	grid:["22222222222222222222000000222222222","22222222222222222222000000222222222","22222222222222222222000000222222222","22222222222222222222000000222222222","22222222222222222222000000222222222","22222222222222222222000000222222222","22222222222222222222000000222222222","22222222222222222222210012222222222","22222222222222222222210012222222222","22222222222222222222210012222222222","22222222222222222222210012222222222","22222222222222222222210012222222222","22222222222222222222210012222222222","22222222222222222222210012222222222","22222222222222222222210012222222222","22222222222222222222210012222222222","22222222222222222222210012222222222","22222200000022222222210012222222222","22222200000022222222222222222222222","22222200000022222222222222222222222","22222200000022222222222222222222222","22222200000011111122222222222222222","22222200000000000022222222222222222","22222200000000000022222222222222222","22222200000011111122222222222222222","22222200000022222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222","22222222222222222222222222222222222"],
	tileset:'v1.2'
},{
	spot:{t2:{x:736,y:48},s1:{x:288,y:608},t1:{x:288,y:672}},
	load:function(spot){
		m.spawnToggle(spot.s1,'viewTg',function(key){
			s.teleport(key,'g0','t3','solo',true);
		});
		m.spawnTeleporter(spot.t2,'tele01','zone','up');
	}
});
s.newMap('g1',{
	name:"Bridge Lvl 2",
	lvl:0,
	screenEffect:'weather',
	grid:["0000000000000000000000001000001000000001000010","0000000000000000000000001000001000000001000010","0001100000000000000000001000001000000001000010","0001100000000001100111101011111000000001000010","0000000011110001100111101011111000000001011010","0000000011110000000111101011111000000001011010","0000000011110000000000001000001000000001000010","0011110000000000000011110000001000000001000010","0011110000000111100100000000001100000011000010","0011110000000111101000000111100111001111111010","0000000000000111101000000111100011001101111010","0000000000000111101000000111100001001001111010","0000000000000000001000000000000001001001111010","0000000000000000001000000011111111111111110010","0000011110000000001000000011111111111111110010","0000011110000000001000000011111111111111110010","0110011110000111101000000011111111111111110010","0110000000000111101011110011111111111111110010","0000000000000111101011110011000000000000110010","0000000000000000001011110011000000000000110010","1111111111111111110000000011000011110000110010","0000000000000000000000000011000011110000110010","0011000000000000000000000011110000000000110010","0011001111111111111111000011110000000000110010","0000011111111111111111100011000000001100110010","0000111111000000000000110011000000001100110010","0001111111000000000000111011000000000000110010","0001111111000000000000111111000000000000110010","0001111111000000000000000011000000001100110010","0001100000000000000000000011000000001100110010","0001100000000000000000111111000000000000110010","0001100000000000000000011011000000000000110010","0001100000000000000000011011110011111111110010","0001100000000000000000111011110011111111110010","0001100000000000000001111011110011111111110010","0001100000000001100011111111110011111111110010","0001100000000011100011111111110011111111110010","0001100000000111100011111000000000000001100010","0001100000000111100010011000000000000001100010","0001100000000110000000000000000000000001111010","0001100000000110000000000000000000000001111010","0001100000000110000000000000000000000001111110","1101100000000110000000000000000000000001111100","1101100000000110000000111111111111111111111000","0001100000000110000001111111111111111111110110","0001100000000111111111000000000000000000000110","0001100000000111111111000000000000000000000000","0001100000000111111111000000000000000000000000"],
	tileset:'v1.2'
},{
	spot:{b7:{x:1120,y:608},b6:{x:992,y:672},b8:{x:1184,y:672},b5:{x:1056,y:736},b4:{x:1056,y:800},a:{x:1120,y:800},s1:{x:416,y:864},b3:{x:1056,y:864},t2:{x:416,y:928},b1:{x:928,y:928},b2:{x:1056,y:928},t1:{x:288,y:1488}},
	load:function(spot){
		m.spawnToggle(spot.s1,'viewTg','tgOn1');
		m.spawnTeleporter(spot.t1,'teleQuit','zone','down');
				
		s.callEvent('spawn',spot,{
			bridgeH:['b1','b2','b3','b4','b5','b6','b7','b8','a'],
		});
	}
});
s.newMap('w1',{
	name:"Bridge Lvl 2",
	lvl:0,
	screenEffect:'weather',
	grid:["2222222222222222222222222222222200000022222222","2222222222222222222222222222222200000022222222","2222222222222222222222222222222200000022222222","2222222222222222222222222222222200000022222222","2222222222222222222222222222222200000022222222","2222222222222222222222222222222200000022222222","2222222222222222222222222222222200000022222222","2222222222222222222222222222222200000022222222","2222222222222222222222222222222200000022222222","2222222222222222222222222222222221001222222222","2222222222222222222222222222222221001222222222","2222222222222222222222222222222221001222222222","2222222222222222222222222222222221001222222222","2222222222222222222222222222222221001222222222","2222222222222222222222222222222221001222222222","2222222222222222222222222222222221001222222222","2222222222222222222222222222222221001222222222","2222222222222222222222222222222221001222222222","2222222222222222222222222222222222222222222222","2222222222222222222222222222222222222222222222","2222222222222222222222222222222222222222222222","2222222222222222222222222222222222222222222222","2222222222222222222222222222222222222222222222","2222222222222222222222222222222222222222222222","2222222222222222222222222222222222222222222222","2222221111000000000000222222222222222222222222","2222221111000000000000222222222222222222222222","2222221111000000000000111111222222222222222222","2222221111000000000000000000222222222222222222","2222220000000000000000000000222222222222222222","2222220000000000000000111111222222222222222222","2222220000000000000000222222222222222222222222","2222220000000000000000222222222222222222222222","2222220000000000000000222222222222222222222222","2222220000000000000002222222222222222222222222","2222220000000002222222222222222222222222222222","2222220000000022222222222222222222222222222222","2222220000000222222222222222222222222222222222","2222220000002222222222222222222222222222222222","2222220000002222222222222222222222222222222222","2222220000002222222222222222222222222222222222","2222220000002222222222222222222222222222222222","2222220000002222222222222222222222222222222222","2222220000002222222222222222222222222222222222","2222220000002222222222222222222222222222222222","2222220000002222222222222222222222222222222222","2222220000002222222222222222222222222222222222","2222220000002222222222222222222222222222222222"],
	tileset:'v1.2'
},{
	spot:{t3:{x:1120,y:48},s1:{x:416,y:864},t2:{x:416,y:928},t1:{x:288,y:1488}},
	load:function(spot){
		m.spawnToggle(spot.s1,'viewTg',function(key){ //
			s.teleport(key,'g1','t2','solo',true);
		});
		m.spawnTeleporter(spot.t3,'tele12','zone','up');
		m.spawnTeleporter(spot.t1,'teleQuit','zone','down');
	}
});
s.newMap('g2',{
	name:"Bridge Lvl 3",
	lvl:0,
	screenEffect:'weather',
	grid:["00000000000000000000000000000000011000000000011000","00000000000000000000000000000000011000000000011000","01111001111111111111111111110000011000000000011000","01111010000000000000000000001000011000000000011000","01111100011111100001111001100100011000000000011011","00000100100000010001111001101100011000000000011011","00000101000000001001111000011000011000000000011000","00000101100000011001111011110000011000000000011000","00000100110000110000000111100000011000000000011000","00000100011111100000000100000000011000000000011000","00000100001111000000000100000000011000000000011000","00000100000000000000000100000000011100000000111000","00000110000000000000000101111000011110100101111000","00000011000000000000000101111000001111100111110000","00000001111000011110000101111111100111100111111110","00000000111100011110000100000111100011100111011110","00000000000100011110000100000111100001100110011110","11000111100100000000001100000000000000100100000000","00100111100100000000011000011111111111111111111000","00010111100110000001110000011111111111111111111000","11110000000011000011100000011111111111111111111000","11101000000001111110000000011111111111111111111000","11100100000000111100000000011111111111111111111000","11101100000000000001111000011000000000000000011000","00011000111100000001111000011000000000000000011000","01110000111100000001111000011000000000000000011000","11100000111100000000000000011000000000000000011000","10000000000000000000000000011000000000000000011000","00000000111111111111111000011000000000000000011000","00000001111111111111111100011000000001111000011000","00000011111100000000011110011000000001111000011000","00000111111100000000011011011110000000000000011000","00000111111100000000000111111110000000000000011000","00000111111100000000000000011000000110000000011000","00000110000000000000000000011000000110000000011000","00000110000000000000000111111000000000000000011000","00000110000000000000000111011000000000000000011000","01111110000000000100011111011110011111111111111000","01111110000000001100011110011110011111111111111000","01111110000000011100011111111110011111111111111000","00000110000000111100011001111110011111111111111000","00000110000000111100010000011110011111111111111111","00000110000000111100010000000000000000000000001111","00000110000000110000000000000000000000000000001111","00000110000000110000000000000000000000000000001111","11110110000000110000000000000000000000000000001111","11110110000000110000000000000000000000000000001111","11110110000000111111111111111111111111111111111111","11110110000000111111111111111111111111111111111111","00000110000000111111111111111111111111111111111111"],
	tileset:'v1.2'
},{
	spot:{t3:{x:1280,y:48},a:{x:960,y:768},b:{x:1024,y:768},c:{x:1088,y:768},d:{x:1152,y:768},e:{x:1216,y:768},q3:{x:1280,y:768},f:{x:1344,y:768},g:{x:1408,y:768},u:{x:960,y:832},q4:{x:1088,y:832},g1:{x:1216,y:832},g3:{x:1344,y:832},h:{x:1408,y:832},v:{x:960,y:896},q5:{x:1088,y:896},C:{x:1152,y:896},g2:{x:1216,y:896},q2:{x:1344,y:896},i:{x:1408,y:896},w:{x:960,y:960},x:{x:1024,y:960},A:{x:1088,y:960},B:{x:1152,y:960},j:{x:1408,y:960},s1:{x:512,y:1024},b3:{x:1024,y:1024},b5:{x:1152,y:1024},b6:{x:1216,y:1024},b7:{x:1280,y:1024},b8:{x:1344,y:1024},k:{x:1408,y:1024},t2:{x:512,y:1088},b1:{x:960,y:1088},b2:{x:1024,y:1088},b4:{x:1088,y:1088},q1:{x:1344,y:1088},l:{x:1408,y:1088},t:{x:960,y:1152},s:{x:1024,y:1152},r:{x:1088,y:1152},q:{x:1152,y:1152},p:{x:1216,y:1152},o:{x:1280,y:1152},n:{x:1344,y:1152},m:{x:1408,y:1152},t1:{x:336,y:1552}},
	load:function(spot){
		m.spawnToggle(spot.s1,'viewTg','tgOn2');
		m.spawnTeleporter(spot.t1,'teleQuit','zone','down');
		
		s.callEvent('spawn',spot,{
			bridgeH:['b1','b2','b3','b4','b5','b6','b7','b8','q1','q2','q4','q5'],
			bridgeV:['q3','s'],
			rock:['g1','g2','g3'],
			block:['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','A','B','C'],
		});
	}
});
s.newMap('w2',{
	name:"Bridge Lvl 3",
	lvl:0,
	screenEffect:'weather',
	grid:["22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222200000000222222","22222222222222222222222222222222222222100122222222","22222222222222222222222222222222222222100122222222","22222222222222222222222222222222222222100122222222","22222222222222222222222222222222222222100122222222","22222222222222222222222222222222222222100122222222","22222222222222222222222222222222222222100122222222","22222222222222222222222222222222222222100122222222","22222222222222222222222222222222222222100122222222","22222222222222222222222222222222222222100122222222","22222222222222222222222222222222222222100122222222","22222222222222222222222222222222222222100122222222","22222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222","22222222111100000000011222222222222222222222222222","22222222111100000000011222222222222222222222222222","22222222111100000000000111111222222222222222222222","22222222111100000000000000000222222222222222222222","22222222000000000000000000000222222222222222222222","22222222000000000000000111111222222222222222222222","22222222000000000000000222222222222222222222222222","22222222000000000000011222222222222222222222222222","22222222000000000222222222222222222222222222222222","22222222000000002222222222222222222222222222222222","22222222000000022222222222222222222222222222222222","22222222000000222222222222222222222222222222222222","22222222000002222222222222222222222222222222222222","22222222000002222222222222222222222222222222222222","22222222000002222222222222222222222222222222222222","22222222000002222222222222222222222222222222222222","22222222000002222222222222222222222222222222222222","22222222000002222222222222222222222222222222222222","22222222000002222222222222222222222222222222222222","22222222000002222222222222222222222222222222222222"],
	tileset:'v1.2'
},{
	spot:{t3:{x:1280,y:48},s1:{x:512,y:1024},t2:{x:512,y:1088},t1:{x:336,y:1552}},
	load:function(spot){
		m.spawnToggle(spot.s1,'viewTg',function(key){ //
			s.teleport(key,'g2','t2','solo',true);
		});
		m.spawnTeleporter(spot.t3,'tele23','zone','up');
		m.spawnTeleporter(spot.t1,'teleQuit','zone','down');
	}
});
s.newMap('g3',{
	name:"Bridge Lvl 4",
	lvl:0,
	screenEffect:'weather',
	grid:["0000000100000000000000000000000000110000000110","0000000100000000000000000000000000110000000110","0000000100000000000000000000000000110000000110","0110001100110000111111111111111111110000000110","0110011000110001111111111111111111111000000110","0001110000000011111100000000000001111110000110","0011100000000111111100000000000000011110000110","1110000000111100000000000000000000011110000110","1100000001111000000000000000000000011110000110","0000000011110000000000000000000000011110001110","0011110111110000000000000000000010011110011110","0011110111110000001111111111111110011110011100","0011110110000000011111111111111110011110011000","0000000110000000111111111111111110011110011111","0000000110000000111111111111111110011110011111","0000000110000000110000000000000010010010011111","0000000110000000110111111111111111111111111000","0000000110000000110111111111111111111111111000","0111100110000000110111111111111111111111111000","0111100110000000110111111111111111111111111000","0111100110000000110111111111111111111111111000","0000000110000000110110000000000000000000011110","0000001110000000110110000000000000000000011110","0000011111100000110111100111111110011110011000","0000111111100000110111100111111110011110011000","0000111111100000110111100110000000000110011000","0000110000000000110111100110000000000110011000","0000110000000000110111100000000000000110011011","0000110000000000110111100000000000000110011011","0000110000000000110111100111100111111110011000","0000110000000000110111100111100111111110011000","0000110000000000110110000000000000000000011000","0110110000000001111110000000000000000000011000","0110110000000000000110000000000000000000011000","0000110000000000000110000000000000000000011000","0000110000000001111110000000000000000000011001","0000110000000000110110000000000000000000011011","0000110000000110110111100111111111111111111110","0000110000000110110111100111111111111111111110","0000110000000001110111100111111111111111111110","0000110000000011111111100111111111111111111110","0000110000000011111111100111111111111111111110","0000110000000011001111000000000001100000000010","0000110000000011001111000000000001100000000010","0000110000000011001111000000000000000000000010","1111110000000011000000000000000000000000000010","1111110000000000000000000000000000000000000010","1111110000000000000000000000000000000001111110","0000110000000000000000000000000000000001111110","0000110000000000000000000000000000000001111110","0000110000000011000000000000000000000001111100","0000110000000011000000111111111111111111111000","0000110000000011111111111111111111111111110000","0000110000000011111111000000000000000000000011","0000110000000011111111000000000000000000000011"],
	tileset:'v1.2'
},{
	spot:{g:{x:1280,y:704},g1:{x:1088,y:768},f:{x:1280,y:768},s1:{x:288,y:896},e:{x:1280,y:896},t2:{x:288,y:960},g2:{x:960,y:960},d:{x:1280,y:960},c:{x:1280,y:1024},b1:{x:704,y:1088},b2:{x:768,y:1088},b3:{x:832,y:1088},b4:{x:896,y:1088},b5:{x:960,y:1088},b6:{x:1024,y:1088},b7:{x:1088,y:1088},b8:{x:1152,y:1088},a:{x:1216,y:1088},b:{x:1280,y:1088},t1:{x:320,y:1712}},
	load:function(spot){
		m.spawnToggle(spot.s1,'viewTg','tgOn3');
		m.spawnTeleporter(spot.t1,'teleQuit','zone','down');
		
		s.callEvent('spawn',spot,{
			bridgeH:['b1','b2','b3','b4','b5','b6','b7','b8','a','b','c','d','e','f','g'],
			rock:['g1','g2'],
		});
	}
});
s.newMap('w3',{
	name:"Bridge Lvl 4",
	lvl:0,
	screenEffect:'weather',
	grid:["2222222222222222222222222222222222222000000222","2222222222222222222222222222222222222000000222","2222222222222222222222222222222222221000000222","2222222222222222222222222222222221111000000222","2222222222222222111122222222222221111000000222","2222222222222222111100000000000001111110000222","2222222222222220111100000000000000011110000222","2222222222222200000000000000000000011110000222","2222222222222000000000000000000000011110000222","2222222222110000000000000000000000011110000222","2222222222110000000222222222222210012210012222","2222222222110000002222222222222210012210012222","2222222222000000022222222222222210012210012222","2222222222000000222222222222222210012210012222","2222222222000002222222222222222210012210012222","2222222222000002222222222222222210012210012222","2222222222000002222222222222222210012210012222","2222222222000002222222222222222210012210012222","2222222222000002222222222222222210012210012222","2222222222000002222222222222222210012210012222","2222222222000002222222222222222210012210012222","2222222220000002222222222222222222222222222222","2222222210000002222222222222222222222222222222","2222222111100002222222222222222222222222222222","2222222111100002222222222222222222222222222222","2222222111100002222222222222222222222222222222","2222222000000002222222222222222222222222222222","2222222000000002222222222222222222222222222222","2222222000000002222222222222222222222222222222","2222222000000002222222222222222222222222222222","2222222000000002222222222222222222222222222222","2222222000000002222222222222222222222222222222","2222222000000001111112222222222222222222222222","2222222000000000000002222222222222222222222222","2222222000000000000002222222222222222222222222","2222222000000001111112222222222222222222222222","2222222000000002222222222222222222222222222222","2222222000000112222222222222222222222222222222","2222222000000112222222222222222222222222222222","2222222000000012222222222222222222222222222222","2222222000000022222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222","2222222000000222222222222222222222222222222222"],
	tileset:'v1.2'
},{
	spot:{t3:{x:1264,y:48},s1:{x:288,y:896},t2:{x:288,y:960},t1:{x:320,y:1712}},
	load:function(spot){
		m.spawnToggle(spot.s1,'viewTg',function(key){ //
			s.teleport(key,'g3','t2','solo',true);
		});
		m.spawnTeleporter(spot.t3,'tele34','zone','up');
		m.spawnTeleporter(spot.t1,'teleQuit','zone','down');
	}
});
s.newMap('g4',{
	name:"Bridge Lvl 5",
	lvl:0,
	screenEffect:'weather',
	grid:["00000000000000000000000001111000000000000000000000000","01100011111111111110000001111000000000000000000000000","01100111111111111111000001111000000000000000110111100","00001111110000000001100000000000000000000000110111100","00011111110000000000111111111111111111111100000111100","00011111110000000000011111111111111111111110000000000","00011111110000000000000000000000000000000011000011000","00011000000000000000000000000000000000000001100011000","00011000000000000000000000000000000000000001100000000","00011000000000000000000000000000000000000011100000111","00011000000000000000000000000000000000100111100001111","00011001100000000000011111111111111111100111111101000","00011001100000111100111111111111111111100110111101000","00011000000000111111111111111111111111100100000001000","00011100000000111111111111111111111111100100000001000","00011110000000111111100000000000000000100100000001000","00001111111111111111000111111111111111111111111001000","00000111111111111110000111111111111111111111111001000","00000011111111111100000111111111111111111111111001000","00000001111111111000000111111111111111111111111001000","00111100000000000011110111111111111111111111111001000","00111100000000000011110110000110000110000000011001000","00111100000110000011110110000110000110000000011001000","00000000000110000000000110000001100000000000011001011","00000000000000000000110110000001100000000000011001011","01100111111111111110110110000000000110000000011001000","01101111111111111111000110000000000110000000011001000","00011111100000000001100110000001100000000000011001000","00111111100000000000110110000001100000000000011001000","00111111100000011000110110000110000000000000011001000","00111111100000011000110110000110000000000000011001000","00110000000000000000110110000000000000011000011001000","00110000000000000001111110000000000000011000011001000","00110000000000000000000110000000000110000000011001000","00110000000000000000000110000000000110000000011001000","00110000000000000001111110000001100000000000011001000","00110000000000000001110110000001100000000000011001000","00110000000000100111110111100111111111111111111001000","00110000000001100111100111100111111111111111111001000","00110000000011100111111111100111111111111111111000100","00110000000111100111111111100111111111111111111111110","00110000000111100111111111100111111111111111111111110","00110000000111100100000000000000000000000000000111110","00110000000110000000000000000000000000000000000100010","00110000000110000000000000000000000000000000011100110","00110000000110000000000000000000000000000000011101100","00110000000110000000000000000000000000000000001111000","00110000000111111000000111111111111111111110001110110","00110000000111111111111000000011000000000001111000110","00110000000111111111110000000011000000000000111000000"],
	tileset:'v1.2'
},{
	spot:{n1:{x:480,y:176},a:{x:832,y:704},b:{x:896,y:704},c:{x:1024,y:704},d:{x:1088,y:704},e:{x:1216,y:704},q6:{x:1280,y:704},f:{x:1344,y:704},g:{x:1408,y:704},C:{x:832,y:768},g1:{x:896,y:768},b6:{x:1152,y:768},b7:{x:1280,y:768},b8:{x:1344,y:768},h:{x:1408,y:768},B:{x:832,y:832},g2:{x:896,y:832},b5:{x:1024,y:832},g5:{x:1216,y:832},g6:{x:1280,y:832},i:{x:1408,y:832},A:{x:832,y:896},g3:{x:896,y:896},b4:{x:1088,y:896},E:{x:1152,y:896},q1:{x:1344,y:896},j:{x:1408,y:896},s1:{x:384,y:960},x:{x:832,y:960},D:{x:1024,y:960},q2:{x:1280,y:960},k:{x:1408,y:960},t2:{x:384,y:1024},w:{x:832,y:1024},b1:{x:896,y:1024},q3:{x:1344,y:1024},l:{x:1408,y:1024},q5:{x:832,y:1088},g4:{x:896,y:1088},b2:{x:960,y:1088},b3:{x:1088,y:1088},q4:{x:1280,y:1088},m:{x:1408,y:1088},v:{x:832,y:1152},u:{x:896,y:1152},t:{x:960,y:1152},s:{x:1088,y:1152},r:{x:1152,y:1152},q:{x:1216,y:1152},p:{x:1280,y:1152},o:{x:1344,y:1152},n:{x:1408,y:1152},t1:{x:240,y:1552}},
	load:function(spot){
		m.spawnToggle(spot.s1,'viewTg','tgOn4');
		m.spawnLoot(spot.n1,'viewTg','endGame','chest');
		m.spawnTeleporter(spot.t1,'teleQuit','zone','down');
		
		
		s.callEvent('spawn',spot,{
			bridgeH:['b1','b2','b3','b4','b5','b6','b7','b8','q1','q2','q3','q4'],
			bridgeV:['q5','q6'],
			rock:['g1','g2','g3','g4','g5','g6'],
			block:['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','A','B','C','D','E'],
		});
	}
});
s.newMap('w4',{
	name:"Bridge Lvl 5",
	lvl:0,
	screenEffect:'weather',
	grid:["22222222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222222","22222211110000000002222222222222222222222222222222222","22222211110000000000222222222222222222222222222222222","22222211110000000000022222222222222222222222222222222","22222211110000000000000000000000000000000022222222222","22222200000000000000000000000000000000000022222222222","22222200000000000000000000000000000000000022222222222","22222200000000000000000000000000000000000022222222222","22222200000000000000002222222222222222100122222222222","22222211100000000000022222222222222222100122222222222","22222211100000111100222222222222222222100122222222222","22222200000000111112222222222222222222100122222222222","22222200000000111122222222222222222222100122222222222","22222222222222222222222222222222222222100122222222222","22222222222222222222222222222222222222100122222222222","22222222222222222222222222222222222222100122222222222","22222222222222222222222222222222222222100122222222222","22222222222222222222222222222222222222100122222222222","22222222222222222222222222222222222222100122222222222","22222222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222222","22222222222222222222222222222222222222222222222222222","22222111100000000002222222222222222222222222222222222","22222111100000000002222222222222222222222222222222222","22222111100000011002222222222222222222222222222222222","22222111100000011002222222222222222222222222222222222","22222000000000000002222222222222222222222222222222222","22222000000000000001111112222222222222222222222222222","22222000000000000000000002222222222222222222222222222","22222000000000000000000002222222222222222222222222222","22222000000000000001111112222222222222222222222222222","22222000000000000002222222222222222222222222222222222","22222000000000000022222222222222222222222222222222222","22222000000000222222222222222222222222222222222222222","22222000000002222222222222222222222222222222222222222","22222000000022222222222222222222222222222222222222222","22222000000222222222222222222222222222222222222222222","22222000002222222222222222222222222222222222222222222","22222000002222222222222222222222222222222222222222222","22222000002222222222222222222222222222222222222222222","22222000002222222222222222222222222222222222222222222","22222000002222222222222222222222222222222222222222222","22222000002222222222222222222222222222222222222222222","22222000002222222222222222222222222222222222222222222","22222000002222222222222222222222222222222222222222222"],
	tileset:'v1.2'
},{
	spot:{n1:{x:480,y:176},s1:{x:384,y:960},t2:{x:384,y:1024},t1:{x:240,y:1552}},
	load:function(spot){
		m.spawnToggle(spot.s1,'viewTg',function(key){ //
			s.teleport(key,'g4','t2','solo',true);
		});
		m.spawnTeleporter(spot.t1,'teleQuit','zone','down');
		m.spawnLoot(spot.n1,'viewTg','endGame','chest');
	}
});
s.newMapAddon('QfirstTown-east',{
	spot:{t5:{x:3152,y:1008}},
	load:function(spot){
		m.spawnActor(spot.t5,'npc',{
			dialogue:'talkPoont',
			sprite:s.newNpc.sprite('villagerFemale-0',1),
			minimapIcon:'minimapIcon-quest',
			angle:s.newNpc.angle('left'),
			nevermove:true,
			name:'Poont',
		});
	}
});

s.exports(exports);
